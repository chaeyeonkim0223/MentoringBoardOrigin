<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ktds.questionformentoring.scheduler.mapper.BoardSchedulerMapper">
    <!--    게시글 현황 삽입-->
    <select id="insertStatus" resultType="BoardStatusDTO">
        insert into "STAT_PSTART_STUS" values (
        now(),
        (select count("PSTART_NO") from "BOARD"),
        (select count("PSTART_NO") from "BOARD" where "SLCTN_YN" = 'Y'),
        (select count("PSTART_NO") from "BOARD" where "SLCTN_YN" = 'N')                                              )
        returning *
    </select>
    <!--    게시글 갯수 (1주일 분량) 가져오기-->
    <select id="getCountByDate" parameterType="map" resultType="BoardCountVo">
        <![CDATA[
        select to_char("TOT_YMD", 'MM.DD') as "TOT_YMD", "TOT_PSTART_NUM" from "STAT_PSTART_STUS"
        where "TOT_YMD" < to_date(#{date},'YYYY-MM-DD') and "TOT_YMD" >= to_date(#{date},'YYYY-MM-DD') -7
        ]]>
    </select>
    <!--    게시글 현황 조회-->
    <select id="getStatusByDate" parameterType="map" resultType="BoardStatusDTO">
        select  to_char("TOT_YMD", 'MM.DD') as "TOT_YMD","TOT_PSTART_NUM","TOT_ANS_CMPTN_PSTART_NUM","TOT_ANS_YET_CMPTN_PSTART_NUM" from "STAT_PSTART_STUS"
        where to_char("TOT_YMD",'YYYY-MM-DD') = #{date}
    </select>
</mapper>
